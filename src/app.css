@tailwind base;
@tailwind components;
@tailwind utilities;

/* =============================================
   THEMING SYSTEM - CSS Custom Properties
   ============================================= */

@layer base {
  /* Default/Dark Theme (base) */
  :root {
    /* Surface colors (backgrounds, borders) */
    --color-surface-50: #f8fafc;
    --color-surface-100: #f1f5f9;
    --color-surface-200: #e2e8f0;
    --color-surface-300: #cbd5e1;
    --color-surface-400: #94a3b8;
    --color-surface-500: #64748b;
    --color-surface-600: #475569;
    --color-surface-700: #334155;
    --color-surface-800: #1e293b;
    --color-surface-850: #141b25;
    --color-surface-900: #0f172a;
    --color-surface-950: #020617;

    /* Accent colors (interactive elements) */
    --color-accent-50: #eff6ff;
    --color-accent-100: #dbeafe;
    --color-accent-200: #bfdbfe;
    --color-accent-300: #93c5fd;
    --color-accent-400: #60a5fa;
    --color-accent-500: #3b82f6;
    --color-accent-600: #2563eb;
    --color-accent-700: #1d4ed8;
    --color-accent-800: #1e40af;
    --color-accent-900: #1e3a8a;
    --color-accent-950: #172554;

    /* Semantic colors */
    --bg-primary: var(--color-surface-900);
    --bg-secondary: var(--color-surface-800);
    --bg-tertiary: var(--color-surface-700);
    --text-primary: var(--color-surface-100);
    --text-secondary: var(--color-surface-300);
    --text-muted: var(--color-surface-400);
    --text-accent: var(--color-accent-400);
    --border-primary: var(--color-surface-700);
    --border-secondary: var(--color-surface-600);

    /* Scrollbar */
    --scrollbar-track: var(--color-surface-800);
    --scrollbar-thumb: var(--color-surface-600);
    --scrollbar-thumb-hover: var(--color-surface-500);

    /* Special effects */
    --crt-scanline: transparent;
    --crt-glow: none;
    --crt-flicker: none;
    --font-story: 'Georgia', 'Cambria', serif;
  }

  /* Light Theme */
  [data-theme="light"] {
    --bg-primary: var(--color-surface-50);
    --bg-secondary: var(--color-surface-100);
    --bg-tertiary: var(--color-surface-200);
    --text-primary: var(--color-surface-900);
    --text-secondary: var(--color-surface-700);
    --text-muted: var(--color-surface-500);
    --text-accent: var(--color-accent-600);
    --border-primary: var(--color-surface-300);
    --border-secondary: var(--color-surface-400);
    --scrollbar-track: var(--color-surface-200);
    --scrollbar-thumb: var(--color-surface-400);
    --scrollbar-thumb-hover: var(--color-surface-500);
  }

  /* =============================================
     PS2 LAIN THEME - Serial Experiments Lain
     Inspired by the PS2 game aesthetic
     ============================================= */
  [data-theme="ps2-lain"] {
    /* Lain color palette - green/cyan CRT aesthetic */
    --color-lain-black: #0a0a0a;
    --color-lain-dark: #0d1a0d;
    --color-lain-green-dark: #0a2a1a;
    --color-lain-green: #00ff41;
    --color-lain-green-dim: #00cc33;
    --color-lain-green-muted: #1a4a2e;
    --color-lain-cyan: #00ffff;
    --color-lain-cyan-dim: #00cccc;
    --color-lain-amber: #ffaa00;
    --color-lain-red: #ff3333;

    /* Override semantic colors */
    --bg-primary: var(--color-lain-black);
    --bg-secondary: var(--color-lain-dark);
    --bg-tertiary: var(--color-lain-green-dark);
    --text-primary: var(--color-lain-green);
    --text-secondary: var(--color-lain-green-dim);
    --text-muted: var(--color-lain-green-muted);
    --text-accent: var(--color-lain-cyan);
    --border-primary: var(--color-lain-green-muted);
    --border-secondary: var(--color-lain-green-dark);
    --scrollbar-track: var(--color-lain-dark);
    --scrollbar-thumb: var(--color-lain-green-muted);
    --scrollbar-thumb-hover: var(--color-lain-green-dim);

    /* Surface colors mapped to Lain palette */
    --color-surface-50: #e0ffe0;
    --color-surface-100: #c0ffc0;
    --color-surface-200: #80ff80;
    --color-surface-300: var(--color-lain-green-dim);
    --color-surface-400: var(--color-lain-green);
    --color-surface-500: var(--color-lain-green-muted);
    --color-surface-600: #1a3a2a;
    --color-surface-700: var(--color-lain-green-dark);
    --color-surface-800: var(--color-lain-dark);
    --color-surface-850: #080f08;
    --color-surface-900: var(--color-lain-black);
    --color-surface-950: #050505;

    /* Accent colors mapped to cyan */
    --color-accent-50: #e0ffff;
    --color-accent-100: #b0ffff;
    --color-accent-200: #80ffff;
    --color-accent-300: #40ffff;
    --color-accent-400: var(--color-lain-cyan);
    --color-accent-500: var(--color-lain-cyan-dim);
    --color-accent-600: #009999;
    --color-accent-700: #007777;
    --color-accent-800: #005555;
    --color-accent-900: #003333;
    --color-accent-950: #001a1a;

    /* CRT Effects */
    --crt-scanline: rgba(0, 255, 65, 0.03);
    --crt-glow: 0 0 10px rgba(0, 255, 65, 0.3), 0 0 20px rgba(0, 255, 65, 0.1);
    --crt-text-glow: 0 0 5px rgba(0, 255, 65, 0.5), 0 0 10px rgba(0, 255, 65, 0.3);

    /* Typography - more digital/monospace feel */
    --font-story: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
  }
}

/* =============================================
   BASE STYLES
   ============================================= */
@layer base {
  html {
    @apply antialiased;
  }

  body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    @apply w-2;
  }

  ::-webkit-scrollbar-track {
    background-color: var(--scrollbar-track);
  }

  ::-webkit-scrollbar-thumb {
    background-color: var(--scrollbar-thumb);
    @apply rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: var(--scrollbar-thumb-hover);
  }
}

/* =============================================
   PS2 LAIN CRT EFFECTS
   ============================================= */

/* CRT Scanlines overlay */
[data-theme="ps2-lain"] body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
  background: repeating-linear-gradient(
    0deg,
    var(--crt-scanline) 0px,
    var(--crt-scanline) 1px,
    transparent 1px,
    transparent 2px
  );
  animation: scanlines 0.1s linear infinite;
}

/* Subtle CRT flicker effect */
[data-theme="ps2-lain"] body::after {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9998;
  background: radial-gradient(
    ellipse at center,
    transparent 0%,
    rgba(0, 0, 0, 0.2) 100%
  );
  animation: crt-flicker 4s ease-in-out infinite;
}

@keyframes scanlines {
  0% {
    background-position: 0 0;
  }
  100% {
    background-position: 0 4px;
  }
}

@keyframes crt-flicker {
  0%, 100% {
    opacity: 0.97;
  }
  50% {
    opacity: 1;
  }
}

/* Text glow effect for Lain theme */
[data-theme="ps2-lain"] h1,
[data-theme="ps2-lain"] h2,
[data-theme="ps2-lain"] h3,
[data-theme="ps2-lain"] .story-text,
[data-theme="ps2-lain"] .narration {
  text-shadow: var(--crt-text-glow);
}

/* Button glow effect */
[data-theme="ps2-lain"] .btn-primary {
  box-shadow: var(--crt-glow);
}

[data-theme="ps2-lain"] .btn-primary:hover {
  box-shadow: 0 0 15px rgba(0, 255, 255, 0.5), 0 0 30px rgba(0, 255, 255, 0.2);
}

/* Input glow on focus */
[data-theme="ps2-lain"] .input:focus {
  box-shadow: 0 0 10px rgba(0, 255, 65, 0.4), 0 0 20px rgba(0, 255, 65, 0.2);
  border-color: var(--color-lain-green);
}

/* Card glow */
[data-theme="ps2-lain"] .card {
  border-color: var(--color-lain-green-muted);
  box-shadow: inset 0 0 30px rgba(0, 255, 65, 0.02);
}

/* System messages in amber */
[data-theme="ps2-lain"] .system-text {
  color: #ffaa00;
  text-shadow: 0 0 5px rgba(255, 170, 0, 0.3);
}

/* User actions in cyan */
[data-theme="ps2-lain"] .user-action {
  color: var(--color-lain-cyan);
  text-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
}

/* =============================================
   COMPONENT STYLES
   ============================================= */
@layer components {
  .btn {
    @apply px-4 py-2 rounded-lg font-medium transition-all duration-200;
  }

  .btn-primary {
    background-color: var(--color-accent-600);
    color: white;
  }

  .btn-primary:hover {
    background-color: var(--color-accent-700);
  }

  .btn-primary:active {
    background-color: var(--color-accent-800);
  }

  .btn-secondary {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
  }

  .btn-secondary:hover {
    background-color: var(--border-secondary);
  }

  .btn-ghost {
    background-color: transparent;
    color: var(--text-secondary);
  }

  .btn-ghost:hover {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
  }

  .input {
    @apply w-full px-3 py-2 rounded-lg transition-all duration-200;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
  }

  .input::placeholder {
    color: var(--text-muted);
  }

  .input:focus {
    @apply outline-none ring-2;
    --tw-ring-color: var(--color-accent-500);
    border-color: transparent;
  }

  /* Select dropdown styling */
  select.input {
    @apply cursor-pointer appearance-none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    padding-right: 2.5rem;
  }

  select.input option {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    padding: 0.5rem;
  }

  select.input option:hover,
  select.input option:focus,
  select.input option:checked {
    background-color: var(--color-accent-600);
    color: white;
  }

  /* Checkbox styling */
  input[type="checkbox"] {
    @apply appearance-none cursor-pointer;
    background-color: var(--bg-tertiary);
    border: 1px solid var(--border-primary);
    transition: all 0.2s ease;
  }

  input[type="checkbox"]:checked {
    background-color: var(--color-accent-600);
    border-color: var(--color-accent-600);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
    background-size: 80%;
    background-position: center;
    background-repeat: no-repeat;
  }

  input[type="checkbox"]:focus {
    @apply outline-none ring-2;
    --tw-ring-color: var(--color-accent-500);
  }

  .card {
    @apply rounded-xl p-4;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-primary);
  }

  .panel {
    background-color: var(--bg-secondary);
    border-right: 1px solid var(--border-primary);
  }
}

/* =============================================
   STORY TEXT STYLING
   ============================================= */
@layer utilities {
  .story-text {
    font-family: var(--font-story);
    @apply text-lg leading-relaxed;
    color: var(--text-secondary);
  }

  .user-action {
    @apply font-medium;
    color: var(--text-accent);
  }

  .narration {
    color: var(--text-secondary);
  }

  .system-text {
    @apply italic text-sm;
    color: var(--text-muted);
  }
}

/* =============================================
   LAIN THEME SPECIFIC ENHANCEMENTS
   ============================================= */

/* Digital noise texture (subtle) */
[data-theme="ps2-lain"] {
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.02'/%3E%3C/svg%3E");
}

/* Glitch effect on hover for interactive elements (optional, subtle) */
[data-theme="ps2-lain"] a:hover,
[data-theme="ps2-lain"] button:hover:not(:disabled) {
  animation: subtle-glitch 0.3s ease-in-out;
}

@keyframes subtle-glitch {
  0%, 100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-1px);
  }
  75% {
    transform: translateX(1px);
  }
}

/* Terminal cursor blink for text inputs */
[data-theme="ps2-lain"] input:focus,
[data-theme="ps2-lain"] textarea:focus {
  caret-color: var(--color-lain-green);
}

/* Override any Tailwind classes that use surface/accent colors */
[data-theme="ps2-lain"] .bg-surface-900 { background-color: var(--color-surface-900); }
[data-theme="ps2-lain"] .bg-surface-800 { background-color: var(--color-surface-800); }
[data-theme="ps2-lain"] .bg-surface-700 { background-color: var(--color-surface-700); }
[data-theme="ps2-lain"] .bg-surface-600 { background-color: var(--color-surface-600); }
[data-theme="ps2-lain"] .text-surface-100 { color: var(--color-surface-100); }
[data-theme="ps2-lain"] .text-surface-200 { color: var(--color-surface-200); }
[data-theme="ps2-lain"] .text-surface-300 { color: var(--color-surface-300); }
[data-theme="ps2-lain"] .text-surface-400 { color: var(--color-surface-400); }
[data-theme="ps2-lain"] .text-surface-500 { color: var(--color-surface-500); }
[data-theme="ps2-lain"] .border-surface-700 { border-color: var(--color-surface-700); }
[data-theme="ps2-lain"] .border-surface-600 { border-color: var(--color-surface-600); }
[data-theme="ps2-lain"] .bg-accent-600 { background-color: var(--color-accent-600); }
[data-theme="ps2-lain"] .bg-accent-700 { background-color: var(--color-accent-700); }
[data-theme="ps2-lain"] .text-accent-400 { color: var(--color-accent-400); }
[data-theme="ps2-lain"] .text-accent-500 { color: var(--color-accent-500); }
[data-theme="ps2-lain"] .text-accent-600 { color: var(--color-accent-600); }
[data-theme="ps2-lain"] .ring-accent-500 { --tw-ring-color: var(--color-accent-500); }
[data-theme="ps2-lain"] .focus\:ring-accent-500:focus { --tw-ring-color: var(--color-accent-500); }

/* Hover states */
[data-theme="ps2-lain"] .hover\:bg-surface-600:hover { background-color: var(--color-surface-600); }
[data-theme="ps2-lain"] .hover\:bg-surface-700:hover { background-color: var(--color-surface-700); }
[data-theme="ps2-lain"] .hover\:bg-surface-800:hover { background-color: var(--color-surface-800); }
[data-theme="ps2-lain"] .hover\:bg-accent-700:hover { background-color: var(--color-accent-700); }
[data-theme="ps2-lain"] .hover\:text-surface-100:hover { color: var(--color-surface-100); }

/* Select styling for Lain theme */
[data-theme="ps2-lain"] select.input {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300ff41' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

[data-theme="ps2-lain"] select.input option {
  background-color: var(--color-lain-dark);
  color: var(--color-lain-green);
}

[data-theme="ps2-lain"] select.input option:checked {
  background-color: var(--color-lain-green-muted);
  color: var(--color-lain-green);
}

/* Select styling for Light theme */
[data-theme="light"] select.input {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23475569' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

[data-theme="light"] select.input option {
  background-color: var(--color-surface-100);
  color: var(--color-surface-900);
}

[data-theme="light"] select.input option:checked {
  background-color: var(--color-accent-600);
  color: white;
}

/* Checkbox styling for Lain theme */
[data-theme="ps2-lain"] input[type="checkbox"]:checked {
  background-color: var(--color-lain-green-muted);
  border-color: var(--color-lain-green);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300ff41' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
}

[data-theme="ps2-lain"] input[type="checkbox"]:focus {
  --tw-ring-color: var(--color-lain-green);
}
